{% extends "rrggweb/quotation/insurance/vehicle/base.html" %}
{% load i18n %}
{% block title_section %}
  {{ title }}
{% endblock title_section %}
{% block content %}
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      {% if step %}
        {% include "rrggweb/utils/stepper.html" with step=3 max_step=6 %}
      {% endif %}
      <a class="btn btn-outline-dark btn-sm mt-3 mb-4" href="{{ previous_page }}">
        <i class="fas fa-long-arrow-alt-left"></i>Volver
      </a>
      {% if seller or customer %}
        <div class="mt-2">
          <h5>
            <b>Asesor:</b> {{ seller }}
          </h5>
          <h5>
            <b>Cliente:</b> {{ customer }}
          </h5>
          <h5>
            <b>Datos de vehículo:</b>
          </h5>
        </div>
        <hr class="w-25" />
      {% endif %}
      <div>
        <form method="post">
          {% csrf_token %}
          <div class="row mb-3">
            <div class="col-md-4 mb-2">
              <label for="id_brand">{{ form.brand.label|capfirst }}:</label>
              {{ form.brand }}
              {% if form.brand.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.brand.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2">
              <label for="id_vehicle_model">{{ form.vehicle_model.label|capfirst }}:</label>
              {{ form.vehicle_model }}
              {% if form.vehicle_model.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.vehicle_model.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2">
              <label for="id_fabrication_year">{{ form.fabrication_year.label|capfirst }}:</label>
              {{ form.fabrication_year }}
              {% if form.fabrication_year.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.fabrication_year.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2">
              <label for="id_plate">{{ form.plate.label|capfirst }}:</label>
              {{ form.plate }}
              {% if form.plate.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.plate.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2">
              <label for="id_chassis">{{ form.chassis.label|capfirst }}:</label>
              {{ form.chassis }}
              {% if form.chassis.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.chassis.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2">
              <label for="id_engine">{{ form.engine.label|capfirst }}:</label>
              {{ form.engine }}
              {% if form.engine.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.engine.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2">
              <label for="id_use_type">{{ form.seat_number.label|capfirst }}</label>
              {{ form.seat_number }}
              {% if form.seat_number.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.seat_number.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2">
              <label for="id_use_type">Uso:</label>
              {{ form.use_type }}
              {% if form.use_type.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.use_type.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2 d-flex gap-2 align-items-center">
              <label for="id_has_gps" class="m-0">¿Tiene gps?:</label>
              {{ form.has_gps }}
              {% if form.has_gps.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.has_gps.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2 d-flex gap-2 align-items-center">
              <label for="id_has_endorsee" class="m-0">¿Es vehículo endosado?:</label>
              {{ form.has_endorsee }}
              {% if form.use_type.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.has_endorsee.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="col-md-4 mb-2 d-none" id="endorsee-bank-container">
              <label for="id_endorsee_bank">Banco endosado:</label>
              {{ form.endorsee_bank }}
              {% if form.endorsee_bank.errors %}
                <div class="alert alert-danger" role="alert">
                  {% for error in form.endorsee_bank.errors %}{{ error }}{% endfor %}
                </div>
              {% endif %}
            </div>
          </div>
        <button class="btn btn-primary btn-block mt-3" type="submit">Siguiente</button>
       </form>
      </div>
   </div>
 </div>

 <script>
  const checkbox = document.querySelector('#id_has_endorsee');
  const container = document.querySelector('#endorsee-bank-container');
  const input = document.querySelector('#id_endorsee_bank');

  checkbox.addEventListener('change', () => {
    if (checkbox.checked) {
      container.classList.remove('d-none');
    } else {
      container.classList.add('d-none');
      input.value = '';
    }
  });
</script>
{% endblock content %}
